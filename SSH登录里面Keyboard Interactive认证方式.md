SSH登录里面Keyboard Interactive认证方式
在对 SSH 有了一个初步的认识之后，我们来看看 SSH 协议是如何做到数据的安全通信。首先来看下 SSH 协议的主要架构：
图 2. SSH 协议的构成
传输层协议： 通常运行在 TCP/IP 的上层，是许多安全网络服务的基础，提供了数据加密、压缩、服务器认证以及保证数据的完整性。比如，公共密钥算法、对称加密算法、消息验证算法等。
用户认证协议：运行在 SSH 协议的传输层之上，用来检测客户端的验证方式是否合法。
连接协议：运行在用户认证层之上，提供了交互登录会话、远程命令的执行、转发 TCP/IP 连接等功能，给数据通讯提供一个安全的，可靠的加密传输信道。
SSH 的应用
在实际的工作中，很多目标机器往往是我们无法直接操作的，这些机器可能是一个公司机房的服务器，也可能是一个远在大洋彼岸的客户环境。这时候我们必须要远程登录到目标机器，执行我们需要的操作，这样不仅降低了运营成本，也提高了执行效率。我们常见的远程登录协议有 SSH、Telnet 等。如上文所提到，Telnet 使用的是明文传输，这样对别有用心的“中间人”来说就有了可乘之机，相对 Telnet 协议，SSH 协议的安全性就高了很多。这样的特性，也使得 SSH 协议迅速被推广，很多的大型项目中都或多或少的使用到了这个协议。下面本文主要讨论 SSH 协议中用户认证协议层，并且下文中统一将远程机器称为服务器（Server），本地机器称为客户端 （Client）。
SSH 的认证协议
常见的 SSH 协议认证方式有如下几种：
基于口令的验证方式（password authentication method），通过输入用户名和密码的方式进行远程机器的登录验证。
基于公共密钥的安全验证方式（public key authentication method），通过生成一组密钥（public key/private key）来实现用户的登录验证。
基于键盘交互的验证方式（keyboard interactive authentication method），通过服务器向客户端发送提示信息，然后由客户端根据相应的信息通过手工输入的方式发还给服务器端。